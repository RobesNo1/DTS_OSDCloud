# =======================
# Custom OSDCloud Landing Page (v1.7 - SetupComplete Replacement Only)
# =======================

# --- OS Selection Variables ---
$OSName       = 'Windows 11 24H2 x64'
$OSEdition    = 'Enterprise'
$OSActivation = 'Retail'
$OSLanguage   = 'en-gb'

# --- Global OSDCloud Settings ---
$Global:MyOSDCloud = [ordered]@{
    Restart                  = $false
    RecoveryPartition        = $true
    OEMActivation            = $true
    WindowsUpdate            = $true
    WindowsUpdateDrivers     = $true
    WindowsDefenderUpdate    = $true
    SetTimeZone              = $true
    ClearDiskConfirm         = $false
    ShutdownSetupComplete    = $false
    SyncMSUpCatDriverUSB     = $true
    CheckSHA1                = $true
}

# --- Info Banner ---
Write-Host "`nStarting OSDCloud for $OSEdition..." -ForegroundColor Yellow
Write-Host ""

# --- Start Deployment ---
Start-OSDCloud -OSName $OSName -OSEdition $OSEdition -OSActivation $OSActivation -OSLanguage $OSLanguage

# --- Post Deployment: SetupComplete Injection ---
Robocopy  X:\OSDCloud\Config\Scripts\SetupComplete C:\Windows\Setup\Scripts /IS

# --- Reboot ---
Write-Host "`nDeployment complete. Press any key to reboot into OOBE..." -ForegroundColor Green
[void][System.Console]::ReadKey($true)
wpeutil reboot
